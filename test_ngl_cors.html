<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NGL Viewer Test - Direct CIF Loading</title>
  <script src="https://unpkg.com/ngl@2.0.0-dev.37/dist/ngl.js"></script>
</head>

<body>
  <h1>NGL Viewer Test - Direct CIF Loading</h1>
  <div id="viewport" style="width:800px; height:600px; border:1px solid #ccc;"></div>
  <button onclick="loadModel()">Load Model</button>

  <script>
    let stage;

    document.addEventListener('DOMContentLoaded', function () {
      // Initialize NGL Stage
      stage = new NGL.Stage('viewport');
      console.log('‚úÖ NGL Stage initialized');

      // Add default controls
      stage.setParameters({
        backgroundColor: 'white'
      });
    });

    function loadModel() {
      const modelUrl = 'http://localhost:5000/api/comparison/2/model/original/view.cif';

      console.log('üß™ Loading model from:', modelUrl);

      stage.loadFile(modelUrl).then(function (component) {
        console.log('‚úÖ Model loaded successfully');
        console.log('Component:', component);

        // Add cartoon representation
        component.addRepresentation('cartoon', {
          color: 'chainid'
        });

        // Auto-center the view
        component.autoView();

        console.log('‚úÖ Representations added');

      }).catch(function (error) {
        console.error('‚ùå Error loading model:', error);
        console.error('Error details:', error.message);
        console.error('Stack trace:', error.stack);
      });
    }
  </script>
</body>

</html>